/***
|''Name''|PagrPlugin|
|''Description''|Simple prev / next / to toc navigation based on a fixed ToC|
|''Documentation''|http://pagr.tiddlyspace.com|
|''Author''|Tobias Beer|
|''~CoreVersion''|2.5.3|
|''Version''|0.5.1 (2013-09-23)|
|''Source''|https://raw.github.com/tobibeer/TiddlyWikiPlugins/master/plugins/PagrPlugin.min.js|
|''License''|[[Creative Commons Attribution-ShareAlike 2.5 License|http://creativecommons.org/licenses/by-sa/2.5/]]|
***/
// /%
(function(e){var t=config.macros.pagr={fmtNext:"[[%0 »|%0]]",fmtHome:"[[▲|%0]]",fmtPrev:"[[« %0|%0]]",toc:"",handler:function(n,r,i,s,o,u){var a,f,l="",c={},h,p,d,v,m,g,y=o.parseParams("anon",null,true);["fmtPrev|p","fmtHome|h","fmtNext|n","toc"].map(function(e){e=e.split("|");c[e[1]?e[1]:e[0]]=getParam(y,e[0],t[e[0]])});a=store.getTiddlerText(c.toc);v=story.findContainingTiddler(n);v=v?v.getAttribute("tiddler"):"";if(!v||!a)return;p=c.toc.indexOf("##");c.toc=c.toc.substr(0,p>0?p:c.toc.length);g=e("<div/>");wikify(a,g[0]);m=[];e(".tiddlyLink",g).each(function(){m.push(e(this).attr("tiddlyLink"))});p=m.indexOf(v);if(p<0)return;h=p-1<0?-1:p-1;next=p+1>=m.length?0:p+1;d=createTiddlyElement(n,"div",null,"pagr");if(c.p&&h>=0)l+=c.p.format([m[h]]);if(c.h)l+=c.h.format([c.toc]);if(c.n&&next)l+=c.n.format([m[next]]);wikify(l,d)}};config.shadowTiddlers.StyleSheetPagr="/*{{{*/\n"+".pagr {margin: 0 0 0.5em 1em;}\n"+".pagr a{padding:5px;}\n"+"/*}}}*/";store.addNotification("StyleSheetPagr",refreshStyles)})(jQuery)
// %/