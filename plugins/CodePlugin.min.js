/***
|''Name''|CodePlugin|
|''Author''|[[Tobias Beer|http://tobibeer.tiddlyspace.com]]|
|''Description''|shows or runs a (commented) code block|
|''Documentation''|http://tobibeer.tiddlyspace.com/#Code|
|''Version''|0.3 (2013-09-04)|
|''~CoreVersion''|2.5.2|
|''License''|Creative Commons 3.0|
|''Source''|https://raw.github.com/tobibeer/TiddlyWikiPlugins/master/plugins/CodePlugin.min.js|
***/
// /%
config.macros.code={lingo:{err:"No Code!",errDetails:"No contents found at '%0'!"},at:"##Code",show:"<html><pre>\n%0\n</pre></html>",handler:function(e,t,n,r,i,s){var o,u=story.findContainingTiddler(e),a=i.parseParams("anon",null,true),f=getParam(a,"run",""),l=getParam(a,"at","");o=f?f:l?l:(u?u.getAttribute("tiddler"):"")+this.at;f=f||n.contains("run");code=store.getTiddlerText(o);if(!code){createTiddlyError(e,this.lingo.err,this.lingo.errDetails.format([o]))}else{code=code.replace(/^(\*\*\*\/)|^(\%\/)/,"");if(code.substr(0,3)=="{{{"&&code.substr(code.length-3)=="}}}")code=code.substr(3,code.length-6);code=jQuery.trim(code);console.log(code);if(f){wikify(code,e)}else{wikify(this.show.format([code.htmlEncode()]),e)}}}}
//%/